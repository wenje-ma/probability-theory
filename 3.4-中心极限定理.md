## 3.4 中心极限定理

### 3.4.1 引理: 复数的乘积差估计 (Lem. 3.4.3)

设 $z_1,z_2,\dots,z_n$ 和 $w_1,w_2,\dots,w_n$ 为复数, 且对任意 m 有 $|z_m| \leq \theta$, $|w_m| \leq \theta$, 则

$$
| \prod_{m=1}^n z_m - \prod_{m=1}^n w_m | \leq \theta^{n-1} \sum_{m=1}^n |z_m - w_m|
$$

#### 证明

采用数学归纳法. 

1. **基例 ($n=1$)**


此时不等式左边为 $|z_1 - w_1|$, 右边为 $\theta^{0}|z_1 - w_1| = |z_1 - w_1|$, 结论成立. 

2. **归纳假设 ($n=k$)**

假设对 $n=k$ 结论成立, 即

$$
| \prod_{m=1}^k z_m - \prod_{m=1}^k w_m | \leq \theta^{k-1} \sum_{m=1}^k |z_m - w_m|
$$

3. **归纳步骤 ($n=k+1$)**

对 $n=k+1$, 拆分乘积差: 

$$
\begin{aligned} | \prod_{m=1}^{k+1} z_m - \prod_{m=1}^{k+1} w_m | &= | z_1 \prod_{m=2}^{k+1} z_m - w_1 \prod_{m=2}^{k+1} w_m | \\ &\leq | z_1 \prod_{m=2}^{k+1} z_m - z_1 \prod_{m=2}^{k+1} w_m | + | z_1 \prod_{m=2}^{k+1} w_m - w_1 \prod_{m=2}^{k+1} w_m | \\ &\leq |z_1| \cdot | \prod_{m=2}^{k+1} z_m - \prod_{m=2}^{k+1} w_m | + | \prod_{m=2}^{k+1} w_m | \cdot |z_1 - w_1| \end{aligned}
$$
由 $|z_1| \leq \theta$ 和 $|w_m| \leq \theta$, 得
$$
| \prod_{m=2}^{k+1} w_m | \leq \theta^{k}.
$$
对 $\prod_{m=2}^{k+1} z_m$ 和 $\prod_{m=2}^{k+1} w_m$ 应用归纳假设 (令 $n=k$) , 可得

$$
| \prod_{m=2}^{k+1} z_m - \prod_{m=2}^{k+1} w_m | \leq \theta^{k-1} \sum_{m=2}^{k+1} |z_m - w_m|
$$
代入上式得

$$
\begin{aligned} \text{LHS} &\leq \theta \cdot \theta^{k-1} \sum_{m=2}^{k+1} |z_m - w_m| + \theta^{k} |z_1 - w_1| \\ &= \theta^{k} \sum_{m=1}^{k+1} |z_m - w_m| \end{aligned}
$$
即 $n=k+1$ 时结论成立. 

由归纳法, 对任意正整数 $n$ 结论成立. 

### 3.4.2 引理: 复指数与一次多项式逼近 (Lem. 3.4.4)

若 b 为复数且 $|b| \leq 1$, 则

$$
|e^b - (1 + b)| \leq |b|^2
$$

#### 证明

由复指数函数的 Taylor 展开式: 

$$
e^b = \sum_{k=0}^\infty \frac{b^k}{k!} = 1 + b + \frac{b^2}{2!} + \frac{b^3}{3!} + \dots
$$
因此

$$
e^b - (1 + b) = \frac{b^2}{2!} + \frac{b^3}{3!} + \frac{b^4}{4!} + \dots
$$
对两边取模, 由三角不等式 $|a_1 + a_2 + \dots| \leq |a_1| + |a_2| + \dots$, 得

$$
\begin{aligned} |e^b - (1 + b)| &\leq \frac{|b|^2}{2!} + \frac{|b|^3}{3!} + \frac{|b|^4}{4!} + \dots \\ &= \frac{|b|^2}{2} ( 1 + \frac{|b|}{3} + \frac{|b|^2}{12} + \dots ) \end{aligned}
$$
当 $|b| \leq 1$ 时, $\frac{|b|}{k} \leq \frac{1}{2}$ 对 $k \geq 2$ 成立, 因此

$$
1 + \frac{|b|}{3} + \frac{|b|^2}{12} + \dots \leq 1 + \frac{1}{2} + \frac{1}{2^2} + \dots = 2
$$
代入得

$$
|e^b - (1 + b)| \leq \frac{|b|^2}{2} \cdot 2 = |b|^2
$$

### 3.4.3 定理: 复数形式的指数极限 (Thm. 3.4.2)

若复数列 $\{c_n\}$ 满足 $c_n \to c \in \mathbb{C}$, 则

$$
(1 + \frac{c_n}{n})^n \to e^c
$$

#### 证明

令 $z_m = 1 + \frac{c_n}{n}$, $w_m = \exp(\frac{c_n}{n})$, $m=1,2,\dots,n$. 

取 $\gamma > |c|$, 由 $c_n \to c$, 当 n 充分大时, $|c_n| < \gamma$. 

由指数函数的不等式 $1 + x \leq e^x$ ($x \geq 0$) , 令 $x = \frac{\gamma}{n}$, 得

$$
1 + \frac{\gamma}{n} \leq \exp(\frac{\gamma}{n})
$$
因此
$$
|z_m| = |1 + \frac{c_n}{n}| \leq 1 + \frac{|c_n|}{n} < 1 + \frac{\gamma}{n} \leq \exp(\frac{\gamma}{n}).
$$
由 Lem. 3.4.3 (取 $\theta = \exp(\frac{\gamma}{n})$) , 得

$$
| \prod_{m=1}^n z_m - \prod_{m=1}^n w_m | \leq ( \exp(\frac{\gamma}{n}) )^{n-1} \sum_{m=1}^n |z_m - w_m|
$$
注意到 $\prod_{m=1}^n z_m = (1 + \frac{c_n}{n})^n$, $\prod_{m=1}^n w_m = \exp(\sum_{m=1}^n \frac{c_n}{n}) = e^{c_n}$, 且 $\sum_{m=1}^n |z_m - w_m| = n \cdot |1 + \frac{c_n}{n} - \exp(\frac{c_n}{n})|$. 

由 Lem. 3.4.4, 令 $b = \frac{c_n}{n}$, 当 n 充分大时 $|b| = \frac{|c_n|}{n} < \frac{\gamma}{n} \leq 1$, 因此

$$
|1 + \frac{c_n}{n} - \exp(\frac{c_n}{n})| \leq | \frac{c_n}{n} |^2 < \frac{\gamma^2}{n^2}
$$
代入乘积差的不等式得

$$
\begin{aligned} | (1 + \frac{c_n}{n})^n - e^{c_n} | &\leq \exp( \frac{\gamma(n-1)}{n} ) \cdot n \cdot \frac{\gamma^2}{n^2} \\ &= \exp( \gamma - \frac{\gamma}{n} ) \cdot \frac{\gamma^2}{n} \\ &\leq e^\gamma \cdot \frac{\gamma^2}{n} \end{aligned}
$$
当 $n \to \infty$ 时, $\frac{\gamma^2}{n} \to 0$, 因此 $(1 + \frac{c_n}{n})^n - e^{c_n} \to 0$, 即 $(1 + \frac{c_n}{n})^n \to e^{c_n}$. 

又由 $c_n \to c$, 指数函数连续, 得 $e^{c_n} \to e^c$, 因此

$$
(1 + \frac{c_n}{n})^n \to e^c
$$

### 3.4.4 定理: 中心极限定理 (CLT) (Thm. 3.4.1)

设 $X_1,X_2,\dots$ 为**独立同分布**的随机变量序列, 满足

$$
\mathbb{E}[X_i] = \mu, \quad \text{var}(X_i) = \sigma^2 \in (0,+\infty)
$$
令 $S_n = X_1 + X_2 + \dots + X_n$, 则标准化和的分布弱收敛于标准正态分布: 

$$
\frac{S_n - n\mu}{\sigma \sqrt{n}} \Rightarrow \chi
$$
其中 $\chi \sim N(0,1)$. 

#### 注意

此处记号 $\chi$ 为非标准记法, 其合理性源于正态分布的平方服从 $\chi^2$ 分布. 

#### 证明

**步骤 1: 中心化简化**

令 $X_i' = X_i - \mu$, 则 $\mathbb{E}[X_i'] = 0$, $\text{var}(X_i') = \sigma^2$, 且

$$
\frac{S_n - n\mu}{\sigma \sqrt{n}} = \frac{\sum_{i=1}^n X_i'}{\sigma \sqrt{n}}
$$
只需证明 $\mu=0$ 时结论成立. 

**步骤 2: 特征函数展开**

设 $\varphi(t) = \mathbb{E}[\exp(itX_1')]$ 为 $X_1'$ 的特征函数. 由泰勒展开, 对任意实数 t, 当 $h \to 0$ 时

$$
\exp(ih) = 1 + ih - \frac{h^2}{2} + o(h^2)
$$
因此

$$
\begin{aligned} \varphi(t) &= \mathbb{E}[1 + itX_1' - \frac{t^2 (X_1')^2}{2} + o(t^2 (X_1')^2)] \\ &= 1 + it \mathbb{E}[X_1'] - \frac{t^2}{2} \mathbb{E}[(X_1')^2] + o(t^2) \end{aligned}
$$
由 $\mathbb{E}[X_1'] = 0$, $\mathbb{E}[(X_1')^2] = \sigma^2$, 得

$$
\varphi(t) = 1 - \frac{\sigma^2 t^2}{2} + o(t^2)
$$
**步骤 3: 标准化和的特征函数**

标准化和 $Y_n = \frac{\sum_{i=1}^n X_i'}{\sigma \sqrt{n}}$ 的特征函数为

$$
\begin{aligned} \varphi_{Y_n}(t) &= \mathbb{E}[\exp(it \cdot \frac{\sum_{i=1}^n X_i'}{\sigma \sqrt{n}})] \\ &= \prod_{i=1}^n \mathbb{E}[\exp(it \cdot \frac{X_i'}{\sigma \sqrt{n}})] \\ &= ( \varphi( \frac{t}{\sigma \sqrt{n}} ) )^n \end{aligned}
$$
代入 $\varphi$ 的展开式, 得

$$
\varphi( \frac{t}{\sigma \sqrt{n}} ) = 1 - \frac{\sigma^2 \cdot \frac{t^2}{\sigma^2 n}}{2} + o( \frac{t^2}{\sigma^2 n} ) = 1 - \frac{t^2}{2n} + o( \frac{1}{n} )
$$
因此

$$
\varphi_{Y_n}(t) = ( 1 - \frac{t^2}{2n} + o( \frac{1}{n} ) )^n
$$
**步骤 4: 极限特征函数**

令 $c_n = -\frac{t^2}{2} + n \cdot o( \frac{1}{n} )$, 则 $c_n \to -\frac{t^2}{2}$. 

由 Thm. 3.4.2, 得

$$
( 1 - \frac{t^2}{2n} + o( \frac{1}{n} ) )^n = ( 1 + \frac{c_n}{n} )^n \to e^{-\frac{t^2}{2}}
$$
而 $e^{-\frac{t^2}{2}}$ 正是标准正态分布 $N(0,1)$ 的特征函数. 

**步骤 5: 弱收敛结论**

由特征函数的连续性定理 (Thm. 3.3.17) : 若随机变量序列的特征函数收敛于某分布的特征函数, 则该序列弱收敛于该分布. 

因此

$$
Y_n = \frac{S_n - n\mu}{\sigma \sqrt{n}} \Rightarrow \chi \sim N(0,1)
$$
