## 1.7 Fubini 定理
### 1.7.1 定理: Tonelli 定理 (Thm. 1.7.2)
设 $(X,\mathcal{F}_1,\mu_1)$ 与 $(Y,\mathcal{F}_2,\mu_2)$ 为两个测度空间, $\mu=\mu_1\times\mu_2$ 为其乘积测度. 若二元函数 $f:X\times Y\to\mathbb{R}$ 是 $\mathcal{F}_1\otimes\mathcal{F}_2$ 可测函数, 且满足**非负性** ($f\ge0$) , 则
$$
\int_X (\int_Y f(x,y)\ \mu_2(dy)) \mu_1(dx) = \int_{X \times Y} f\ d\mu = \int_Y (\int_X f(x,y)\ \mu_1(dx)) \mu_2(dy)\tag{*}
$$

#### 证明
我们仅证明等式
$$
\int_X (\int_Y f(x,y)\ \mu_2(dy)) \mu_1(dx) = \int_{X \times Y} f\ d\mu
$$
第二个等式可由对称性直接推出. 

1.  **示性函数情形**


若 $E\in\mathcal{F}_1\otimes\mathcal{F}_2$, 且 $f=1_E$ ($E$ 的示性函数) , 则式 (*) 可由 Lem. 1.7.4 (乘积测度的定义性质) 直接推出. 此时
$$
\int_{X\times Y}1_E d\mu=\mu(E)=\int_X\mu_2(E_x)\mu_1(dx)=\int_X(\int_Y1_E(x,y)\mu_2(dy))\mu_1(dx)
$$
其中 $E_x=\{y\in Y:(x,y)\in E\}$ 为 $E$ 在 $x$ 处的截口. 

2. **非负简单函数情形**

简单函数可表示为示性函数的线性组合: $f=\sum_{i=1}^n a_i 1_{E_i}$, 其中 $a_i\ge0$, $E_i\in\mathcal{F}_1\otimes\mathcal{F}_2$. 
由于积分具有线性性, 对示性函数成立的结论可直接推广到简单函数, 即式 (*) 对非负简单函数成立. 

3. **非负可测函数情形**

若 $f\ge0$, 构造非负简单函数列 $\{f_n\}$ 满足
$$
f_n(x,y)=(\frac{\lfloor 2^n f(x,y)\rfloor}{2^n})\land n
$$
其中 $\lfloor x\rfloor$ 表示不超过 $x$ 的最大整数. 易知 $\{f_n\}$ 满足 $0\le f_n\uparrow f$ (单调递增收敛于 $f$) . 
对 $\{f_n\}$ 应用单调收敛定理 (MCT), 结合简单函数的结论, 可得
$$
\begin{aligned}
\int_{X\times Y}f d\mu&=\lim_{n\to\infty}\int_{X\times Y}f_n d\mu \\
&=\lim_{n\to\infty}\int_X(\int_Y f_n(x,y)\mu_2(dy))\mu_1(dx) \\
&=\int_X(\int_Y f(x,y)\mu_2(dy))\mu_1(dx)
\end{aligned}
$$

4. **绝对可积函数情形**

若 $f$ 绝对可积, 即 $\int_{X\times Y}|f|d\mu<\infty$, 将 $f$ 分解为正部与负部: 
$$
f=f^+-f^-
$$
其中 $f^+=\max\{f,0\}$, $f^-=\max\{-f,0\}$, 且 $|f|=f^++f^-$. 

由绝对可积性可知 $f^+,f^-$ 均可积, 对 $f^+,f^-$ 分别应用非负可测函数的结论, 再利用积分的线性性, 即可得到式 (*) 对 $f$ 成立. 

### 1.7.2 定理: Fubini 定理
设 $(X,\mathcal{F}_1,\mu_1)$ 与 $(Y,\mathcal{F}_2,\mu_2)$ 为两个测度空间, $\mu=\mu_1\times\mu_2$ 为其乘积测度. 若二元函数 $f:X\times Y\to\mathbb{R}$ 是 $\mathcal{F}_1\otimes\mathcal{F}_2$ 可测函数, 且满足**绝对可积性** ($\int_{X\times Y}|f|d\mu<\infty$) , 则
$$
\int_X (\int_Y f(x,y)\ \mu_2(dy)) \mu_1(dx) = \int_{X \times Y} f\ d\mu = \int_Y (\int_X f(x,y)\ \mu_1(dx)) \mu_2(dy)\tag{*}
$$

