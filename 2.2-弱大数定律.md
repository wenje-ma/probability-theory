## 2.2 弱大数定律
### 2.2.1 定义: 依概率收敛
随机变量序列 $Y_n$ **依概率收敛**到随机变量 $Y$, 若对任意 $\epsilon > 0$, 当 $n \to \infty$ 时, 有
$$
P(|Y_n - Y| > \epsilon) \to 0
$$
记作 $Y_n \xrightarrow{P} Y$. 

该收敛的直观描述: 当 $n$ 足够大时, $Y_n$ 与 $Y$ 的偏差超过任意小正数 $\epsilon$ 的概率趋近于 $0$. 

### 2.2.2 定理: 不相关随机变量和的方差性质 (Thm. 2.2.1)
设 $X_1, X_2, \dots, X_n$ 满足 $E(X_i^2) < \infty$ 且**互不相关**, 则
$$
\text{var}( \sum_{i=1}^n X_i ) = \sum_{i=1}^n \text{var}(X_i)
$$
其中方差的定义为 $\text{var}(Y) = E[(Y - EY)^2]$. 

#### 证明
令 $\mu_i = EX_i$, $S_n = \sum_{i=1}^n X_i$, 则 $ES_n = \sum_{i=1}^n \mu_i$. 

按方差定义展开计算: 
$$
\begin{aligned}
\text{var}(S_n) &= E( S_n - ES_n )^2 = E( \sum_{i=1}^n (X_i - \mu_i) )^2 \\
&= E( \sum_{i=1}^n \sum_{j=1}^n (X_i - \mu_i)(X_j - \mu_j) ) \\
&= \sum_{i=1}^n E[(X_i - \mu_i)^2] + 2\sum_{1 \leq i < j \leq n} E[(X_i - \mu_i)(X_j - \mu_j)]
\end{aligned}
$$
- 第一项 $\sum_{i=1}^n E[(X_i - \mu_i)^2]$ 即为 $\sum_{i=1}^n \text{var}(X_i)$; 
- 第二项中, 因 $X_i$ 与 $X_j$ 不相关, 协方差 $\text{cov}(X_i,X_j)=E[(X_i - \mu_i)(X_j - \mu_j)] = 0$, 故交叉项和为 $0$. 

定理得证. 

### 2.2.3 引理: $L^p$ 收敛蕴含依概率收敛 (Lem. 2.2.2)
若 $p > 0$ 且 $E|Z_n|^p \to 0$, 则 $Z_n \xrightarrow{P} 0$. 

#### 证明
对任意 $\epsilon > 0$, 应用 **Markov 不等式** (取 $\varphi(x)=x^p$, $X=|Z_n|$) : 
$$
P(|Z_n| > \epsilon) = P(|Z_n|^p > \epsilon^p) \leq \frac{E|Z_n|^p}{\epsilon^p}
$$
由条件 $E|Z_n|^p \to 0$, 可得 $P(|Z_n| > \epsilon) \to 0$, 即 $Z_n \xrightarrow{P} 0$. 

### 2.2.4 定理: $L^2$ 弱大数定律 ($L^2$-WLLN) (Thm. 2.2.3)
设 $X_1, X_2, \dots$ 是**互不相关**的随机变量, 满足
1.  $EX_i = \mu$ (期望相同) ; 
2.  $\text{var}(X_i) \leq C < \infty$ (方差一致有界) . 

令 $S_n = \sum_{i=1}^n X_i$, 则当 $n \to \infty$ 时
3.  $\frac{S_n}{n}$ 在 $L^2$ 中收敛到 $\mu$, 即 $E| \frac{S_n}{n} - \mu |^2 \to 0$; 
4.  $\frac{S_n}{n}$ 依概率收敛到 $\mu$, 即 $\frac{S_n}{n} \xrightarrow{P} \mu$. 

#### 证明
(3) **$L^2$ 收敛证明**

由期望的线性性, $E( \frac{S_n}{n} ) = \mu$, 因此
$$
E| \frac{S_n}{n} - \mu |^2 = \text{var}( \frac{S_n}{n} )
$$
结合 Thm. 2.2.1 及方差一致有界条件, 计算得
$$
\text{var}( \frac{S_n}{n} ) = \frac{1}{n^2} \sum_{i=1}^n \text{var}(X_i) \leq \frac{nC}{n^2} = \frac{C}{n} \to 0 \quad (n \to \infty)
$$
即 $E| \frac{S_n}{n} - \mu |^2 \to 0$, $L^2$ 收敛得证. 

(4) **依概率收敛证明**

由 Lem. 2.2.2 (取 $p=2$, $Z_n = \frac{S_n}{n} - \mu$) , 因 $E| Z_n |^2 \to 0$, 故 $Z_n \xrightarrow{P} 0$, 即 $\frac{S_n}{n} \xrightarrow{P} \mu$. 

### 2.2.5 补充定理: 一般弱大数定律 (截断法, Thm. 2.2.12) 
设 $X_1, X_2, \dots$ 是**独立同分布**随机变量, $S_n = \sum_{i=1}^n X_i$. 
对每个 $n$, 定义截断随机变量
$$
\tilde{X}_{n,i} = X_i \cdot 1_{\{|X_i| \leq n\}}
$$
 ($1$ 为指示函数) , 记 $\tilde{S}_n = \sum_{i=1}^n \tilde{X}_{n,i}$, $\mu_n = E( \tilde{X}_{n,1} )$. 

若满足
1.  $n P(|X_1| > n) \to 0$ (截断误差概率收敛到 $0$) ; 
2.  $\frac{1}{n^2} \text{var}(\tilde{S}_n) \to 0$ (中心化截断和的方差满足条件) , 

则 $\frac{S_n}{n} - \mu_n \xrightarrow{P} 0$. 

#### 证明
- 第一步: 估计 $S_n$ 与 $\tilde{S}_n$ 不相等的概率
  

$$
P(S_n \neq \tilde{S}_n) = P( \bigcup_{i=1}^n |X_i| > n ) \leq \sum_{i=1}^n P(|X_i| > n) = n P(|X_1| > n) \to 0
$$
该式由条件 (1) 及独立同分布性质得到. 

- 第二步: 估计 $\tilde{X}_{n,1}$ 的二阶矩


应用积分形式的二阶矩公式 (Lem. 2.2.13, $p=2$) : 
$$
E\tilde{X}_{n,1}^2 = \int_0^\infty 2y P(|\tilde{X}_{n,1}| > y) dy \leq \int_0^n 2y P(|X_1| > y) dy
$$
由条件 $y P(|X_1| > y) \to 0 \ (y \to \infty)$, 函数 $g(y)=2y P(|X_1| > y)$ 有界且 $g(y) \to 0$. 

令 $y = nx$ 作变量替换, 得
$$
\frac{1}{n} E\tilde{X}_{n,1}^2 \leq \frac{1}{n} \int_0^n g(y) dy = \int_0^1 g(nx) dx \to 0
$$

- 第三步: 验证方差条件


由独立同分布性, $\text{var}(\tilde{S}_n) = n \text{var}(\tilde{X}_{n,1}) \leq n E\tilde{X}_{n,1}^2$, 因此
$$
\frac{\text{var}(\tilde{S}_n)}{n^2} \leq \frac{E\tilde{X}_{n,1}^2}{n} \to 0
$$

- 第四步: 结合 $L^2$-WLLN 推广结论

由 Thm. 2.2.6 可得 $\frac{\tilde{S}_n - E\tilde{S}_n}{n} \xrightarrow{P} 0$. 

因 $E\tilde{S}_n = n \mu_n$, 且 $P(S_n \neq \tilde{S}_n) \to 0$, 故 $\frac{S_n}{n} - \mu_n \xrightarrow{P} 0$. 

### 2.2.6 定理: $L^1$ 弱大数定律 ($L^1$-WLLN, Thm. 2.2.14)
设 $X_1, X_2, \dots$ 是**独立同分布**随机变量, 满足 $E|X_1| < \infty$. 

令 $S_n = \sum_{i=1}^n X_i$, $\mu = EX_1$, 则
$$
\frac{S_n}{n} \xrightarrow{P} \mu
$$

#### 证明
- 第一步: 验证 Thm. 2.2.12 的条件 (1)
  

由 $E|X_1| < \infty$, 应用**控制收敛定理 (DCT)**: 
$$
n P(|X_1| > n) \leq E( |X_1| \cdot \mathbb{1}_{\{|X_1| > n\}} ) \to 0 \quad (n \to \infty)
$$

- 第二步: 验证截断期望的收敛性


同样由控制收敛定理, 因 $|X_1 \cdot \mathbb{1}_{\{|X_1| \leq n\}}| \leq |X_1|$ 且 $E|X_1| < \infty$, 故
$$
\mu_n = E( X_1 \cdot \mathbb{1}_{\{|X_1| \leq n\}} ) \to E(X_1) = \mu \quad (n \to \infty)
$$

- 第三步: 结合依概率收敛的三角不等式

由 Thm. 2.2.12, 对任意 $\epsilon > 0$, 有
$$
P( | \frac{S_n}{n} - \mu_n | > \frac{\epsilon}{2} ) \to 0
$$
又因 $\mu_n \to \mu$, 存在 $N$, 当 $n > N$ 时 $|\mu_n - \mu| < \frac{\epsilon}{2}$. 

由三角不等式
$$
| \frac{S_n}{n} - \mu | \leq | \frac{S_n}{n} - \mu_n | + |\mu_n - \mu|
$$
可得
$$
P( | \frac{S_n}{n} - \mu | > \epsilon ) \leq P( | \frac{S_n}{n} - \mu_n | > \frac{\epsilon}{2} ) \to 0
$$
即 $\frac{S_n}{n} \xrightarrow{P} \mu$, 定理得证. 

