# 3 中心极限定理
## 3.2 弱收敛
### 3.2.1 定义: 分布函数的弱收敛
设 $\{F_n\}_{n=1}^\infty$ 是一列分布函数, $F$ 是一个分布函数. 若对 $F$ 的**所有连续点** $y$, 都有
$$
F_n(y) \to F(y) \quad (n \to \infty)
$$
则称分布函数列 $\{F_n\}$ **弱收敛**到 $F$, 记作 $F_n \Rightarrow F$. 

### 3.2.2 定义: 随机变量的弱收敛 (依分布收敛) 
设 $\{X_n\}_{n=1}^\infty$ 是一列随机变量, $X_\infty$ 是一个随机变量, 它们的分布函数分别为 $\{F_n\}$ 和 $F_\infty$. 

若 $F_n \Rightarrow F_\infty$, 则称随机变量序列 $\{X_n\}$ **弱收敛** (或**依分布收敛**) 到 $X_\infty$, 记作 $X_n \Rightarrow X_\infty$. 

### 3.2.3 定理: Skorohod 定理 (Thm. 3.2.8)
若分布函数列 $F_n \Rightarrow F_\infty$, 则存在定义在**同一概率空间** $(\Omega, \mathcal{F}, P)$ 上的随机变量序列 $\{Y_n\}_{n=1}^\infty$ 和随机变量 $Y_\infty$, 满足
1.  $Y_n$ 的分布函数为 $F_n$ (即 $Y_n$ 与 $X_n$ 同分布) ; 
2.  $Y_n \to Y_\infty$ **几乎必然** (a.s.) . 

#### 证明
**步骤1: 构造公共概率空间**

取 $\Omega = (0,1)$, $\mathcal{F}$ 为 $(0,1)$ 上的 Borel 集族, $P$ 为 Lebesgue 测度. 

对每个 $n$ (包括 $n=\infty$) , 定义
$$
Y_n(x) = \sup\{ y \in \mathbb{R}: F_n(y) < x \}, \quad x \in (0,1)
$$
称 $Y_n$ 为 $F_n$ 的**逆分布函数** (或**分位数函数**) . 

由概率分布的基本性质, $Y_n$ 的分布函数恰好是 $F_n$, 即 $P(Y_n \leq y) = F_n(y)$. 

**步骤2: 定义几乎必然收敛的点集**

对 $x \in (0,1)$, 定义
$$
a_x = \sup\{ y: F_\infty(y) < x \}, \quad b_x = \inf\{ y: F_\infty(y) > x \}
$$
令 $\Omega_0 = \{ x \in (0,1): (a_x, b_x) = \emptyset \}$, 即 $a_x = b_x$ 的点集. 

对任意 $x \in \Omega_0$, 记 $Y_\infty(x) = a_x = b_x$. 

**步骤3: 上下极限估计**

需要证明对 $x \in \Omega_0$, $\liminf_{n \to \infty} Y_n(x) \geq Y_\infty(x)$ 且 $\limsup_{n \to \infty} Y_n(x) \leq Y_\infty(x)$. 

1. **下极限估计**: $\liminf_{n \to \infty} Y_n(x) \geq Y_\infty(x)$

任取 $y < Y_\infty(x)$ 且 $y$ 是 $F_\infty$ 的连续点, 则 $F_\infty(y) < x$. 

由 $F_n \Rightarrow F_\infty$, 当 $n$ 充分大时, $F_n(y) < x$. 

根据 $Y_n(x)$ 的定义, 有 $Y_n(x) \geq y$. 

令 $y \to Y_\infty(x)^-$, 得 $\liminf_{n \to \infty} Y_n(x) \geq Y_\infty(x)$. 

2. **上极限估计**: $\limsup_{n \to \infty} Y_n(x) \leq Y_\infty(x)$

任取 $y > Y_\infty(x)$ 且 $y$ 是 $F_\infty$ 的连续点, 则 $F_\infty(y) > x$. 

由 $F_n \Rightarrow F_\infty$, 当 $n$ 充分大时, $F_n(y) > x$. 

根据 $Y_n(x)$ 的定义, 有 $Y_n(x) \leq y$. 

令 $y \to Y_\infty(x)^+$, 得 $\limsup_{n \to \infty} Y_n(x) \leq Y_\infty(x)$. 

**步骤4: 几乎必然收敛结论**

结合上下极限的估计, 对 $x \in \Omega_0$, 有 $Y_n(x) \to Y_\infty(x)$. 

由于 $\Omega \setminus \Omega_0$ 是零测集, 故 $Y_n \to Y_\infty$ 几乎必然. 

### 3.2.4 定理: 弱收敛的等价刻画 (Thm. 3.2.9)
随机变量序列 $X_n \Rightarrow X_\infty$ 的**充要条件**是: 对任意**有界连续函数** $g: \mathbb{R} \to \mathbb{R}$, 都有
$$
Eg(X_n) \to Eg(X_\infty) \quad (n \to \infty)
$$

#### 证明
1. **必要性** ($X_n \Rightarrow X_\infty \implies Eg(X_n) \to Eg(X_\infty)$) 

由 Skorohod 定理, 存在同分布的随机变量序列 $Y_n \sim X_n$, $Y_\infty \sim X_\infty$, 且 $Y_n \to Y_\infty$ a.s.. 

- 因为 $g$ 是连续函数, 所以 $g(Y_n) \to g(Y_\infty)$ a.s.; 
- 又因为 $g$ 有界, 由**控制收敛定理**得
  $$
  Eg(X_n) = Eg(Y_n) \to Eg(Y_\infty) = Eg(X_\infty)
  $$

2. **充分性** (对任意有界连续函数 $g$, $Eg(X_n) \to Eg(X_\infty) \implies X_n \Rightarrow X_\infty$) 

需要证明: 对 $F_\infty$ 的任意连续点 $x$, 有 $F_n(x) \to F_\infty(x)$. 

**构造有界连续函数**: 对任意 $\epsilon > 0$, 定义
$$
g_{x,\epsilon}(y) = \begin{cases} 1, & y \leq x \\ 1 - \frac{y - x}{\epsilon}, & x < y < x + \epsilon \\ 0, & y \geq x + \epsilon \end{cases}
$$
显然 $g_{x,\epsilon}$ 是有界连续函数, 且满足
$$
1_{\{y \leq x\}} \leq g_{x,\epsilon}(y) \leq 1_{\{y \leq x + \epsilon\}}
$$

**上极限估计**: 

对上述函数 $g_{x,\epsilon}$, 由充分性条件得 $Eg_{x,\epsilon}(X_n) \to Eg_{x,\epsilon}(X_\infty)$, 因此
$$
\limsup_{n \to \infty} F_n(x) = \limsup_{n \to \infty} P(X_n \leq x) \leq \limsup_{n \to \infty} Eg_{x,\epsilon}(X_n) = Eg_{x,\epsilon}(X_\infty) \leq P(X_\infty \leq x + \epsilon)
$$
令 $\epsilon \to 0$, 由于 $x$ 是 $F_\infty$ 的连续点, 故 $P(X_\infty \leq x + \epsilon) \to F_\infty(x)$, 得
$$
\limsup_{n \to \infty} F_n(x) \leq F_\infty(x)
$$

**下极限估计**: 

类似地, 构造函数 $g_{x-\epsilon,\epsilon}(y)$, 可得
$$
\liminf_{n \to \infty} F_n(x) = \liminf_{n \to \infty} P(X_n \leq x) \geq \liminf_{n \to \infty} Eg_{x-\epsilon,\epsilon}(X_n) = Eg_{x-\epsilon,\epsilon}(X_\infty) \geq P(X_\infty \leq x - \epsilon)
$$
令 $\epsilon \to 0$, 由于 $x$ 是 $F_\infty$ 的连续点, 故 $P(X_\infty \leq x - \epsilon) \to F_\infty(x)$, 得
$$
\liminf_{n \to \infty} F_n(x) \geq F_\infty(x)
$$

**结论**: 结合上下极限的估计, 有 $F_n(x) \to F_\infty(x)$, 即 $X_n \Rightarrow X_\infty$. 

