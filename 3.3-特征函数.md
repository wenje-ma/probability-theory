## 3.3 特征函数
### 3.3.1 定义: 特征函数
若 $X$ 为随机变量, 则其**特征函数** (简记为 ch.f.) 定义为
$$
\varphi(t) = Ee^{itX} = E\cos tX + iE\sin tX
$$
其中 $i=\sqrt{-1}$ 为虚数单位, 该定义对任意随机变量 $X$ 均成立 (积分绝对收敛) . 

### 3.3.2 定义: 实部, 虚部, 模, 共轭复数
设 $Z$ 为复值随机变量, 定义其期望为
$$
EZ = E(\text{Re}Z) + iE(\text{Im}Z)
$$
对复数 $z = a + bi$ ($a,b\in\mathbb{R}$) : 
- **实部**: $\text{Re}(z) = a$
- **虚部**: $\text{Im}(z) = b$
- **模**: $|z| = \sqrt{a^2 + b^2}$
- **共轭复数**: $\bar{z} = a - bi$

### 3.3.3 定理: 特征函数的基本性质 (Thm. 3.3.1)
任意随机变量的特征函数均满足以下性质: 
1.  $\varphi(0) = 1$; 
2.  $\varphi(-t) = \overline{\varphi(t)}$; 
3.  $|\varphi(t)| \leq 1$; 
4.  $\varphi(t)$ 在 $\mathbb{R}$ 上**一致连续**; 
5.  **线性变换性质**: 对任意常数 $a,b$, $Ee^{it(aX+b)} = e^{itb}\varphi(at)$. 

#### 证明

代入 $t=0$, 得
$$
\varphi(0)=Ee^{i\cdot0\cdot X}=E1=1;
$$
利用三角函数奇偶性 $\cos(-x)=\cos x$, $\sin(-x)=-\sin x$, 有
$$
\varphi(-t)=E(\cos(-tX)+i\sin(-tX))=E(\cos tX - i\sin tX)=\overline{\varphi(t)}.
$$
由期望的绝对值不等式 $|EZ|\leq E|Z|$, 结合 $|e^{itX}|=\sqrt{\cos^2tX+\sin^2tX}=1$, 得
$$
|\varphi(t)|=|Ee^{itX}|\leq E|e^{itX}|=1
$$
估计差值的模: 
$$
|\varphi(t+h)-\varphi(t)|=|E(e^{i(t+h)X}-e^{itX})|=|Ee^{itX}(e^{ihX}-1)|\leq E|e^{ihX}-1|
$$
右端与 t 无关, 且当 $h\to0$ 时, 由**有界收敛定理**得 $E|e^{ihX}-1|\to0$, 故 $\varphi(t)$ 一致连续; 

变形期望表达式: 
$$
Ee^{it(aX+b)}=E(e^{itb}\cdot e^{i(ta)X})=e^{itb}Ee^{i(ta)X}=e^{itb}\varphi(at)
$$

### 3.3.4 定理: 独立随机变量和的特征函数 (Thm. 3.3.2)
设 $X_1,X_2$ 相互独立, 特征函数分别为 $\varphi_1(t),\varphi_2(t)$, 则 $X_1+X_2$ 的特征函数为
$$
\varphi_{X_1+X_2}(t)=\varphi_1(t)\cdot\varphi_2(t)
$$

#### 证明
由独立性, 乘积的期望等于期望的乘积: 
$$
\varphi_{X_1+X_2}(t)=Ee^{it(X_1+X_2)}=E(e^{itX_1}\cdot e^{itX_2})=Ee^{itX_1}\cdot Ee^{itX_2}=\varphi_1(t)\varphi_2(t)
$$

### 3.3.5 示例: 正态分布的特征函数 (Ex. 3.3.5)
**标准正态分布** $X\sim N(0,1)$, 概率密度 $f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}$, 特征函数为
$$
\varphi(t)=e^{-\frac{t^2}{2}}
$$
**一般正态分布** $X\sim N(\mu,\sigma^2)$, 特征函数为
$$
\varphi(t)=e^{i\mu t-\frac{\sigma^2t^2}{2}}
$$

#### 证明

- 标准正态分布: 


写出特征函数的积分形式
$$
\varphi(t)=\int_{-\infty}^\infty e^{itx}\cdot\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx
$$
被积函数的虚部 $i\sin tx \cdot \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}$ 是奇函数, 积分值为 0, 因此

$$
\varphi(t)=\int_{-\infty}^\infty \cos tx\cdot\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx
$$
对 t 求导并分部积分: 

$$
\varphi'(t)=\int_{-\infty}^\infty -x\sin tx\cdot\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=\int_{-\infty}^\infty \sin tx\cdot\frac{1}{\sqrt{2\pi}}d(e^{-\frac{x^2}{2}})
$$
边界项在 $\pm\infty$ 处为 0, 化简得
$$
\varphi'(t)=-t\varphi(t).
$$
解此微分方程, 结合初始条件 $\varphi(0)=1$, 得
$$
\varphi(t)=e^{-\frac{t^2}{2}}.
$$

- 一般正态分布: 

令 $X=\sigma Z+\mu$ (其中 $Z\sim N(0,1)$) , 由特征函数的线性变换性质得
$$
\varphi_X(t)=e^{it\mu}\varphi_Z(\sigma t)=e^{it\mu}\cdot e^{-\frac{(\sigma t)^2}{2}}=e^{i\mu t-\frac{\sigma^2t^2}{2}}
$$

### 3.3.6 定义: 实分析 Fourier 变换 $^*$

设 $f\in C_c^\infty(\mathbb{R})$ ($\mathbb{R}$ 上紧支集无穷次可微函数) , 定义其 **Fourier 变换**为
$$
\hat{f}(\xi)=\int_{-\infty}^\infty e^{-i\xi x}f(x)dx,\quad \xi\in\mathbb{R}
$$

### 3.3.7 定义: 实分析 Fourier 逆变换 $^*$

对任意 $f\in C_c^\infty(\mathbb{R})$, 有 **Fourier 逆变换公式**
$$
f(x)=\frac{1}{2\pi}\int_{-\infty}^\infty e^{i\xi x}\hat{f}(\xi)d\xi,\quad \forall x\in\mathbb{R}
$$

#### 注意

实分析与概率论中 Fourier 变换的指数符号相反: 

- 实分析: $e^{-i\xi x}$
- 概率论: 特征函数 $\varphi(t)=Ee^{itX}$ 为 $e^{itx}$ 形式. 

两者可通过换元 $\xi=-t$ 相互转化. 

### 3.3.8 定理: Parseval 关系 $^*$

设 $Y$ 为随机变量, $\varphi_Y(\xi)$ 为其特征函数, 则对任意 $f\in C_c^\infty(\mathbb{R})$, 有
$$
Ef(Y)=\frac{1}{2\pi}\int_{\mathbb{R}}\hat{f}(\xi)\varphi_Y(\xi)d\xi
$$

#### 证明

对 Fourier 逆变换公式两边取期望, 交换期望与积分次序 (由控制收敛定理) : 
$$
Ef(Y)=\frac{1}{2\pi}E[\int_{\mathbb{R}}e^{i\xi Y}\hat{f}(\xi)d\xi]=\frac{1}{2\pi}\int_{\mathbb{R}}\hat{f}(\xi)Ee^{i\xi Y}d\xi=\frac{1}{2\pi}\int_{\mathbb{R}}\hat{f}(\xi)\varphi_Y(\xi)d\xi
$$

### 3.3.9 定理: 逆变换公式 (Thm. 3.3.11) 

设 $\varphi(t) = \int e^{itx}\mu(dx)$, 其中 $\mu$ 是概率测度. 对任意实数 $a < b$, 有
$$
\lim_{T \to \infty} (2\pi)^{-1} \int_{-T}^T \frac{e^{-ita} - e^{-itb}}{it} \varphi(t) dt = \mu(a,b) + \frac{1}{2}\mu(\{a,b\})
$$

#### 证明

记

$$
I_T = \int_{-T}^T \frac{e^{-ita} - e^{-itb}}{it} \varphi(t) dt = \int_{-T}^T \frac{e^{-ita} - e^{-itb}}{it} ( \int e^{itx}\mu(dx) ) dt
$$
利用恒等式 $\frac{e^{-ita} - e^{-itb}}{it} = \int_a^b e^{-ity} dy$, 可知被积函数的模被 $b - a$ 有界控制. 由**富比尼定理**交换积分次序, 化简得

$$
I_T = \int ( \int_{-T}^T \frac{\sin(t(x - a))}{t} dt - \int_{-T}^T \frac{\sin(t(x - b))}{t} dt ) \mu(dx)
$$
令 $R(\theta, T) = \int_{-T}^T \frac{\sin(\theta t)}{t} dt$, $S(T) = \int_0^T \frac{\sin x}{x} dx$, 则 $R(\theta, T) = 2(\text{sign}\theta) S(T|\theta|)$. 当 $T \to \infty$ 时, $S(T) \to \frac{\pi}{2}$, 因此

$$
R(x - a, T) - R(x - b, T) \to \begin{cases} 2\pi & a < x < b \\ \pi & x = a \text{ 或 } x = b \\ 0 & x < a \text{ 或 } x > b \end{cases}
$$
对 $I_T$ 应用**有界收敛定理**, 即得结论. 

#### 注记

该定理是 Parseval 关系的特例: 取 f 为区间 $(a,b)$ 上的近似指示函数, 取极限后即可得到精确的区间测度表达式. 

### 3.3.10 定理: Fourier 逆变换密度 (Thm. 3.3.14)

若特征函数满足 $\int |\varphi(t)| dt < \infty$, 则概率测度 $\mu$ 具有**有界连续的密度函数**
$$
f(y) = \frac{1}{2\pi} \int e^{-ity}\varphi(t) dt
$$

#### 证明

由定理 3.3.9 的证明可知

$$
| \frac{e^{-ita} - e^{-itb}}{it} | = | \int_a^b e^{-ity} dy | \leq |b - a|
$$
因此积分绝对收敛, 且

$$
\mu(a,b) + \frac{1}{2}\mu(\{a,b\}) = \frac{1}{2\pi} \int_{-\infty}^\infty \frac{e^{-ita} - e^{-itb}}{it} \varphi(t) dt
$$
由于 $\int |\varphi(t)|dt < \infty$, $\mu$ 无点质量 ($\mu(\{x\})=0$) , 故

$$
\mu(x, x + h) = \frac{1}{2\pi} \int ( \int_x^{x + h} e^{-ity} dy ) \varphi(t) dt = \int_x^{x + h} ( \frac{1}{2\pi} \int e^{-ity}\varphi(t) dt ) dy
$$
记 $f(y) = \frac{1}{2\pi} \int e^{-ity}\varphi(t) dt$, 由**控制收敛定理**可证 $f$ 连续, 且 $\mu(a,b)=\int_a^b f(y)dy$, 即 $f$ 为 $\mu$ 的密度函数. 

### 3.3.11 定理: 特征函数的连续性定理 (Thm. 3.3.17)

设 $\mu_n$ ($1 \leq n \leq \infty$) 是概率测度, 对应的特征函数为 $\varphi_n$, 则

1. 若 $\mu_n \Rightarrow \mu_\infty$ (**弱收敛**) , 则对所有 $t\in\mathbb{R}$, 有 $\varphi_n(t) \to \varphi_\infty(t)$; 
1. 若 $\varphi_n(t)$ 逐点收敛到极限 $\varphi(t)$, 且 $\varphi(t)$ 在 0 处连续, 则分布序列 $\{\mu_n\}$ 是**胎紧**的, 且弱收敛到以 $\varphi$ 为特征函数的概率测度 $\mu$. 

#### 证明

1. 

因 $e^{itx}$ 是有界连续函数, 由弱收敛的定义 (对任意有界连续函数 f, $\int f d\mu_n \to \int f d\mu_\infty$) , 直接得
$$
\varphi_n(t)=\int e^{itx}d\mu_n \to \int e^{itx}d\mu_\infty=\varphi_\infty(t).
$$

2. 

**胎紧性证明**: 计算积分

$$
\int_{-u}^u 1 - e^{itx} dt = 2u - \int_{-u}^u (\cos tx + i\sin tx) dt = 2u - \frac{2\sin ux}{x}
$$
两边除以 u 并对 $\mu_n(dx)$ 积分, 交换积分次序得

$$
u^{-1} \int_{-u}^u (1 - \varphi_n(t)) dt = 2 \int (1 - \frac{\sin ux}{ux}) \mu_n(dx)
$$
由 $|\sin x|\leq |x|$, 得 $1 - \frac{\sin ux}{ux} \geq 0$. 舍弃 $|x|<2/u$ 的积分区域, 利用 $|\sin ux|\leq1$, 得

$$
u^{-1} \int_{-u}^u (1 - \varphi_n(t)) dt \geq \mu_n(\{x : |x| > 2/u\})
$$
因 $\varphi(t)$ 在 0 处连续且 $\varphi(0)=1$, 故
$$
u^{-1} \int_{-u}^u (1 - \varphi(t)) dt \to 0
$$
($u\to0$) . 结合 $\varphi_n(t)\to\varphi(t)$, 由有界收敛定理得 $\{\mu_n\}$ 胎紧. 

**弱收敛证明**: 胎紧序列必有弱收敛子序列 $\{\mu_{n_k}\}$, 其极限测度的特征函数为 $\varphi$. 由子序列的收敛性及胎紧性, 可得整个序列 $\{\mu_n\}$ 弱收敛到 $\mu$. 

### 3.3.12 定理: 依分布收敛的等价刻画 $^*$

设随机变量序列 $\{X_n\}$ 的分布函数为 $\{F_n\}$, 特征函数为 $\{\varphi_n\}$; $X_\infty$ 的分布函数为 $F_\infty$, 特征函数为 $\varphi_\infty$. 则以下命题等价: 

1. $F_n(x)\to F_\infty(x)$, $\forall x\in D_{F_\infty}$ ($D_{F_\infty}$ 为 $F_\infty$ 的连续点) ; 
1. 存在共同概率空间上的随机变量序列 $\{Y_n\}$ 与 $Y_\infty$, 满足 $Y_n\stackrel{d}{=}X_n$, $Y_\infty\stackrel{d}{=}X_\infty$ 且 $Y_n\stackrel{a.s.}{\to}Y_\infty$; 
1. $\mathbb{E}[f(X_n)]\to\mathbb{E}[f(X_\infty)]$, $\forall f\in C_b(\mathbb{R})$ ($C_b(\mathbb{R})$ 为 $\mathbb{R}$ 上有界连续函数空间) ; 
1. $\varphi_n(t)\to\varphi_\infty(t)$, $\forall t\in\mathbb{R}$; 
1. $\mathbb{E}[f(X_n)]\to\mathbb{E}[f(X_\infty)]$, $\forall f\in C_c^\infty(\mathbb{R})$; 
1. $\mathbb{E}[f(X_n)]\to\mathbb{E}[f(X_\infty)]$, $\forall f\in C_c(\mathbb{R})$ ($C_c(\mathbb{R})$ 为 $\mathbb{R}$ 上紧支集连续函数空间) . 

### 3.3.13 定理: 特征函数的光滑性定理 (Thm. 3.3.18)

若随机变量 X 的 n 阶绝对矩有限, 即 $\int |x|^n \mu(dx) < \infty$, 则其特征函数 $\varphi(t)$ 具有 **n 阶连续导数**, 且
$$
\varphi^{(n)}(t) = \int (ix)^n e^{itx}\mu(dx)
$$

#### 证明

通过**反复在积分号下求导**验证. 对 $k=1$, 导数定义为

$$
\varphi'(t)=\lim_{h\to0}\frac{\varphi(t+h)-\varphi(t)}{h}=\lim_{h\to0}\int e^{itx}\cdot\frac{e^{ihx}-1}{h}\mu(dx)
$$
由 $|\frac{e^{ihx}-1}{h}|\leq |x|$ 及 $\int |x|\mu(dx)<\infty$, 利用**控制收敛定理**交换极限与积分次序, 得
$$
\varphi'(t)=\int ix e^{itx}\mu(dx).
$$
同理可证 $k>1$ 的情况, 且导数连续. 
